prometheus.exporter.unix "default" {
}

prometheus.scrape "default" {
  targets    = prometheus.exporter.unix.default.targets
  forward_to = [prometheus.remote_write.default.receiver]
}

prometheus.remote_write "default" {
  endpoint {
    url = "{{ prometheus_push_url }}"
  }
}

loki.source.journal "default" {
  forward_to = [loki.write.default.receiver]
  relabel_rules {
    rule {
      target_label = "resource_id"
      replacement  = "{{ resource_id }}"
    }
  }
}

loki.write "default" {
  endpoint {
    url = "{{ loki_push_url }}"
  }
}
